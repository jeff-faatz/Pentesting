#!/bin/bash

# Author: Jeff Faatz
# Date: 11/2/2022
# Description: Automated Recon Script
# This script is for Educational purposes only. Any actions and or activities related to the material contained within this script is solely your responsibility.

# To run the script - ./full_enumeration.sh TARGETDOMAIN
# To run a single scanning program - ./full_enumeration.sh TARGETDOMAIN SCANTYPE-only

echo "
  _____   ____    _   _   _   _   _  __  __  __    ___    _   _   _  __  _____  __   __
 |_   _| |  _ \  | | | | | \ | | | |/ / |  \/  |  / _ \  | \ | | | |/ / | ____| \ \ / /
   | |   | |_) | | | | | |  \| | | ' /  | |\/| | | | | | |  \| | | ' /  |  _|    \ V / 
   | |   |  _ <  | |_| | | |\  | | . \  | |  | | | |_| | | |\  | | . \  | |___    | |  
   |_|   |_| \_\  \___/  |_| \_| |_|\_\ |_|  |_|  \___/  |_| \_| |_|\_\ |_____|   |_|  
"
                                                                                       
# Makes a new directory in your current directory named after your DOMAIN
DOMAIN=$1    
DIRECTORY=${DOMAIN}
echo "Creating directory $DIRECTORY."
mkdir $DIRECTORY

# Scans and their options
nmap_scan()
{
    nmap -sV -sC $DOMAIN > $DIRECTORY/nmap
    echo "The results of the nmap scan are stored in $DIRECTORY/nmap."
}
gobuster_scan()
{
    gobuster dir -u $DOMAIN -w /usr/share/wordlists/dirbuster/directory-list-2.3-small.txt -o $DIRECTORY/gobuster
    echo "The results of the gobuster scan are stored in $DIRECTORY/gobuster."
}
emailharvester_scan()
{
    emailharvester -d $DOMAIN -e googles > $DIRECTORY/emailharvester.json
    echo "The results of the emailharvester scan are stored in $DIRECTORY/emailharvester.json."
}
dnsenum_scan()
{
    dnsenum $DOMAIN -o $DIRECTORY/dnsenum
    echo "The results of the dnsenum scan are stored in $DIRECTORY/dnsenum."
}
    
# Scan types
case $MODE in
    nmap-only)
        nmap_scan
        ;;
    gobuster-only)
        dirsearch_scan
        ;;
    emailharvester-only)
        emailharvester_scan
        ;;
    dnsenum-only)
        dnsenum_scan
        ;;
    *)
        nmap_scan
        gobuster_scan
        emailharvester_scan
        dnsenum_scan
        ;;
esac
    
# Generates a combined report of all the individual scan reports
echo "Generating report for $DOMAIN..."
TODAY=$(date)
echo "This scan was created on $TODAY" > $DIRECTORY/report
echo "Results for nmap:" >> $DIRECTORY/report
cat $DIRECTORY/nmap >> $DIRECTORY/report
echo "Results for gobuster:" >> $DIRECTORY/report
cat $DIRECTORY/gobuster >> $DIRECTORY/report
echo "Results for emailharvester:" >> $DIRECTORY/report
cat $DIRECTORY/emailharvester.json >> $DIRECTORY/report
echo "Results for dnsenum:" >> $DIRECTORY/report
cat $DIRECTORY/dnsenum >> $DIRECTORY/report

# END
