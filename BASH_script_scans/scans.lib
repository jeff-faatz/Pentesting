#!/bin/bash

# Required .lib file to go with full_enumeration.sh script

nmap_scan()
{
    nmap -sV -sC $DOMAIN > $DIRECTORY/nmap
    echo "The results of the nmap scan are stored in $DIRECTORY/nmap."
}
gobuster_scan()
{
    gobuster dir -u $DOMAIN -w /usr/share/wordlists/dirbuster/directory-list-2.3-small.txt -o $DIRECTORY/gobuster
    echo "The results of the gobuster scan are stored in $DIRECTORY/gobuster."
}
theharvester_scan()
{
    theharvester -d $DOMAIN -l 50 -b all -f $DIRECTORY/theharvester
    echo "The results of the theharvester scan are stored in $DIRECTORY/theharvester."
}
dnsrecon_scan()
{
    dnsrecon -d $DOMAIN -t axfr > dnsrecon-report
    echo "The results of the dnsrecon AXFR scan are stored in $DIRECTORY/dnsrecon-AXFR."
    dnsrecon -D /usr/share/dnsrecon/namelist.txt -t brt -d $DOMAIN > dnsrecon-bruteforce
    echo "The results of the dnsrecon bruteforce scan are stored in $DIRECTORY/dnsrecon-bruteforce."
    dnsrecon -d $DOMAIN -a > dnsrecon-zone-transfer
    echo "The results of the dnsrecon zone transfer scan are stored in $DIRECTORY/dnsrecon-zone-transfer."
    dnsrecon -d $DOMAIN -t tld > dnsrecon-tld
    echo "The results of the dnsrecon tld scan are stored in $DIRECTORY/dnsrecon-tld."
}
wfuzz_scan)
{
    wfuzz -c -z file,/usr/share/wfuzz/wordlist/general/common.txt --hc 404 https://$DOMAIN/index.php?id=FUZZ > wfuzz
    echo "The results of the wfuzz scan are stored in $DIRECTORY/wfuzz."
}
sslyze_scan)
{
    sslyze --regular $DOMAIN > sslyze
    echo "The results of the sslyze scan are stored in $DIRECTORY/sslyze."
}
