#!/bin/bash
source ./scans.lib
getopts "m:" OPTION
MODE=$OPTARG
for i in "${@:$OPTIND:$#}"
do
    DOMAIN=$1
    DIRECTORY=${DOMAIN}_recon
    echo "Creating directory $DIRECTORY."
    mkdir $DIRECTORY
    case $MODE in
        nmap-only)
            nmap_scan
            ;;
        gobuster-only)
            gobuster_scan
            ;;
        *)
            nmap_scan
            gobuster_scan
            ;;
    esac
    echo "Generating recon report for $DOMAIN..."
    TODAY=$(date)
    echo "This scan was created on $TODAY" > $DIRECTORY/report
    if [ -f $DIRECTORY/nmap ];then
        echo "Results for nmap:" >> $DIRECTORY/report
        cat $DIRECTORY/nmap >> $DIRECTORY/report
    fi
    if [ -f $DIRECTORY/gobuster ];then
        echo "Results for gobuster:" >>$DIRECTORY/report
        cat $DIRECTORY/gobuster >> $DIRECTORY/report
    fi
done
